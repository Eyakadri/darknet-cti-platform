%% Mermaid Diagram: Threat Scoring Composition
flowchart LR
    subgraph Inputs[Signals]
        CVE[CVE Count]
        ACT[Threat Actor Mentions]
        MAL[Malware Families]
        HASH[File/Breach Artifacts]
        IPs[IP Addresses]
        EM[Email Count]
        GEO[Country References]
        LEAK[High Email Density]
    end
    WEIGHTS[[Weighted Linear Combiner]]
    SCORE(((Threat Score\n0..100)))

    CVE --> WEIGHTS
    ACT --> WEIGHTS
    MAL --> WEIGHTS
    HASH --> WEIGHTS
    IPs --> WEIGHTS
    EM --> WEIGHTS
    GEO --> WEIGHTS
    LEAK --> WEIGHTS
    WEIGHTS --> SCORE

    classDef box fill:#161b22,stroke:#30363d,color:#c9d1d9
    classDef accent fill:#1f6feb,stroke:#58a6ff,color:#fff
    class Inputs,WEIGHTS,SCORE box
    class SCORE accent
